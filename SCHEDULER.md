# Stock Trader 자동 실행 가이드

## 📅 개요

Stock Trader 프로그램을 **월~금요일 오전 8:40**에 자동으로 실행하는 방법을 설명합니다.

장 시작 시간: 09:00
프로그램 시작: 08:40 (20분 전 - 로그인 및 준비 시간)

---

## 🚀 빠른 시작

### 1. 실행 파일 빌드
```cmd
빌드.bat
```

### 2. 자동 실행 등록
```cmd
작업_스케줄러_등록.bat
```
**⚠️ 관리자 권한으로 실행해야 합니다!**

### 3. 확인
```cmd
작업_스케줄러_확인.bat
```

---

## 📋 상세 설정

### 자동 실행 설정 내용

| 항목 | 설정값 |
|------|--------|
| **작업 이름** | StockTrader_Auto |
| **실행 요일** | 월, 화, 수, 목, 금 |
| **실행 시간** | 오전 8:40 |
| **실행 파일** | `C:\MyAPP\stock_trading\dist\stock_trader.exe` |
| **권한** | 최고 권한 (관리자) |

---

## 🔧 배치 파일 설명

### 작업_스케줄러_등록.bat
**기능:**
- 기존 작업 확인 및 삭제
- 새 작업 등록
- 설정 확인

**사용법:**
```cmd
작업_스케줄러_등록.bat
```

**출력 예시:**
```
==========================================
 Stock Trader 자동 실행 설정
==========================================

월~금요일 오전 8:40에 자동 실행됩니다.

실행 파일 확인: C:\MyAPP\stock_trading\dist\stock_trader.exe

작업 스케줄러 등록 중...

==========================================
 등록 성공!
==========================================

✅ 작업 이름: StockTrader_Auto
✅ 실행 시간: 월~금 오전 8:40
✅ 실행 파일: C:\MyAPP\stock_trading\dist\stock_trader.exe
✅ 권한: 최고 권한으로 실행
```

---

### 작업_스케줄러_확인.bat
**기능:**
- 등록된 작업 정보 확인
- 수동 테스트 실행
- 작업 활성화/비활성화

**메뉴:**
```
1. 작업 스케줄러 열기 (GUI)
2. 수동 테스트 실행
3. 작업 비활성화
4. 작업 활성화
5. 종료
```

---

### 작업_스케줄러_삭제.bat
**기능:**
- 등록된 작업 삭제

**사용법:**
```cmd
작업_스케줄러_삭제.bat
```

---

## 🎯 사용 시나리오

### 시나리오 1: 처음 설정
```cmd
1. 빌드.bat                    # exe 파일 생성
2. 작업_스케줄러_등록.bat       # 자동 실행 등록
3. 작업_스케줄러_확인.bat       # 등록 확인
```

### 시나리오 2: 테스트
```cmd
작업_스케줄러_확인.bat
→ "2. 수동 테스트 실행" 선택
→ 프로그램이 즉시 실행됨
```

### 시나리오 3: 임시 비활성화
```cmd
작업_스케줄러_확인.bat
→ "3. 작업 비활성화" 선택
→ 자동 실행 중지 (재활성화 전까지)
```

### 시나리오 4: 설정 제거
```cmd
작업_스케줄러_삭제.bat
→ Y 입력
→ 자동 실행 완전 삭제
```

---

## 🖥️ Windows 작업 스케줄러 GUI 설정 (수동)

### 방법 1: 배치 파일 사용 (권장) ✅
위의 `작업_스케줄러_등록.bat` 사용

### 방법 2: 수동 설정

1. **작업 스케줄러 열기**
   - `Win + R` → `taskschd.msc` → Enter

2. **새 작업 만들기**
   - "작업 만들기" 클릭

3. **일반 탭**
   - 이름: `StockTrader_Auto`
   - 설명: `Stock Trader 자동 실행 (월~금 8:40)`
   - ✅ 가장 높은 권한으로 실행
   - 운영체제: Windows 10

4. **트리거 탭**
   - "새로 만들기" 클릭
   - 시작: 일정에 따라
   - 설정: 매주
   - 요일: ✅ 월요일, 화요일, 수요일, 목요일, 금요일
   - 시작 시간: 오전 8:40
   - ✅ 사용

5. **동작 탭**
   - "새로 만들기" 클릭
   - 동작: 프로그램 시작
   - 프로그램/스크립트: `C:\MyAPP\stock_trading\dist\stock_trader.exe`
   - 시작 위치: `C:\MyAPP\stock_trading\dist`

6. **조건 탭**
   - ❌ 컴퓨터의 AC 전원이 켜져 있을 때만 (체크 해제)
   - ❌ 컴퓨터를 깨워서 실행 (필요시 체크)

7. **설정 탭**
   - ✅ 작업 실행 실패 시 다시 시작 간격: 1분
   - ✅ 다시 시도 횟수: 3회

8. **확인** 클릭

---

## ⚠️ 중요 사항

### 1. 컴퓨터가 켜져 있어야 함
```
자동 실행은 컴퓨터가 켜져 있을 때만 동작합니다.
→ 절전 모드나 종료 상태에서는 실행 안 됨
```

### 2. 로그인 상태 유지
```
Windows 로그인 상태여야 프로그램이 실행됩니다.
→ 로그아웃/잠금 상태에서는 실행 제한될 수 있음
```

### 3. 자동 로그인 설정 필요
```
프로그램 내 "자동 로그인" 체크박스를 사용하거나
settings.ini에 로그인 정보 저장 필요
```

---

## 🔍 확인 및 관리

### 작업 스케줄러에서 확인
```cmd
# 방법 1: GUI
Win + R → taskschd.msc → Enter
→ "StockTrader_Auto" 작업 찾기

# 방법 2: 명령어
schtasks /Query /TN "StockTrader_Auto" /V
```

### 작업 실행 기록 확인
```
작업 스케줄러 → StockTrader_Auto 우클릭 → 기록
→ 실행 성공/실패 이력 확인
```

### 수동 테스트
```cmd
# 즉시 실행 (테스트용)
schtasks /Run /TN "StockTrader_Auto"
```

---

## 🛠️ 문제 해결

### 문제 1: "작업을 찾을 수 없음"
**원인:** 등록되지 않았거나 삭제됨

**해결:**
```cmd
작업_스케줄러_등록.bat
```

### 문제 2: "액세스가 거부되었습니다"
**원인:** 관리자 권한 없음

**해결:**
```cmd
배치 파일 우클릭 → "관리자 권한으로 실행"
```

### 문제 3: 실행은 되는데 프로그램이 안 뜸
**원인:** 
- exe 파일 경로 오류
- 로그인 정보 미설정

**해결:**
```
1. 경로 확인: dist\stock_trader.exe 존재하는지
2. 수동 실행 테스트: stock_trader.exe 더블클릭
3. 자동 로그인 설정: settings.ini에 계정 정보 저장
```

### 문제 4: 특정 요일만 실행 안 됨
**원인:** Windows 업데이트, 휴일 설정 등

**해결:**
```cmd
# 작업 기록 확인
작업 스케줄러 → StockTrader_Auto → 기록 탭
→ 실패 이유 확인
```

---

## 📝 추가 설정 (선택사항)

### 자동 로그인 설정 (프로그램 내)

#### settings.ini 파일:
```ini
[LOGIN]
username = your_id
password = your_password
cert_password = your_cert
auto_login = true
```

**⚠️ 보안 주의:**
- 비밀번호가 평문으로 저장됨
- 파일 권한 설정 권장
- 중요한 계정은 사용 자제

---

### Windows 자동 로그인 (컴퓨터 부팅 시)

**설정 방법:**
```cmd
1. Win + R → netplwiz → Enter
2. "사용자 계정" 창
3. ❌ "사용자가 이 컴퓨터를 사용하려면..." 체크 해제
4. 확인 → 비밀번호 입력
5. 재부팅 테스트
```

**⚠️ 보안 경고:**
- 누구나 컴퓨터 접근 가능
- 물리적 보안이 확보된 환경에서만 사용

---

## 🎯 최종 자동화 시나리오

### 완전 자동화 구성:

```
1. Windows 자동 로그인 설정
   ↓
2. 작업 스케줄러 등록
   ↓
3. 프로그램 자동 로그인 설정 (settings.ini)
   ↓
4. 결과:

   월요일 08:40
   ↓
   [자동] Windows 부팅 → 자동 로그인
   ↓
   [자동] stock_trader.exe 실행
   ↓
   [자동] 크레온 로그인
   ↓
   [자동] 전략 로드 및 매매 시작
   ↓
   15:20 장 종료 후 프로그램 종료
```

---

## 📊 작업 스케줄러 명령어 모음

```cmd
# 등록
schtasks /Create /TN "StockTrader_Auto" /TR "경로" /SC WEEKLY ...

# 조회
schtasks /Query /TN "StockTrader_Auto"

# 실행 (수동 테스트)
schtasks /Run /TN "StockTrader_Auto"

# 삭제
schtasks /Delete /TN "StockTrader_Auto" /F

# 비활성화
schtasks /Change /TN "StockTrader_Auto" /DISABLE

# 활성화
schtasks /Change /TN "StockTrader_Auto" /ENABLE

# 수정 (시간 변경)
schtasks /Change /TN "StockTrader_Auto" /ST 08:30
```

---

## 🔍 로그 확인

### 작업 실행 로그
```
작업 스케줄러 → StockTrader_Auto → 기록 탭
→ 마지막 실행 시간, 결과 확인
```

### 프로그램 로그
```
C:\MyAPP\stock_trading\log\trading_YYYYMMDD.log
→ 프로그램 실행 기록
```

---

## ✅ 체크리스트

### 설정 전:
- [ ] stock_trader.exe 빌드 완료
- [ ] 수동 실행 테스트 완료
- [ ] 자동 로그인 설정 완료 (settings.ini)

### 설정 후:
- [ ] 작업 스케줄러 등록 완료
- [ ] 작업 정보 확인
- [ ] 수동 테스트 실행 성공
- [ ] 다음 거래일에 자동 실행 확인

### 운영 중:
- [ ] 주간 실행 기록 확인
- [ ] 로그 파일 확인
- [ ] 필요시 설정 조정

---

**이제 월~금요일 오전 8:40에 자동으로 프로그램이 실행됩니다!** 🎉

